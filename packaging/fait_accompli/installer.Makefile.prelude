all: gpt @prewsmds@ @gridftp@ @prewsgram@ @rls@ @myproxy@ @gsiopenssh@ @wsjava@ @wsmds@ @wsdel@ @wsrft@ @wsgram@ @wsgramcondor@ @wsgramlsf@ @wsgrampbs@ @wscas@ @webmds@ @wsc@ @i18n@ @tests@ @wstests@ @drs@ 
GLOBUS_LOCATION=@prefix@
GPT_LOCATION=@gptlocation@
GLOBUS_IODBC_PATH=@globus_iodbc@
export GLOBUS_IODBC_PATH GPT_LOCATION GLOBUS_LOCATION
BUILD_OPTS=@buildopts@
FLAVOR=@flavor@
THR=@thr@
@aixargs@

# Cleanup targets
clean:
	rm -f gpt-stamp
distclean: clean
	rm -f Makefile config.status config.log

# Functional group dependencies, expressed in bundles.
common: gpt globus_core globus_libtool globus_common globus_common_setup
i18n: gpt common globus-internationalization globus-internationalization-thr
prews: prewsmds gridftp prewsgram
prewsgram: gpt globus-resource-management-sdk-thr globus-resource-management-server globus-resource-management-client globus-resource-management-sdk 
gridftp: gpt globus-data-management-sdk-thr globus-data-management-server globus-data-management-client globus-data-management-sdk 
prewsmds: gpt globus-information-services-server globus-information-services-client globus-information-services-sdk
rls: gpt globus-rls-server
wsjava: gpt gt4-java-ws-core gt4-java-ws-core-test
wsmds: gpt wsjava gt4-mds gt4-mds-test
webmds: gpt wsjava gt4-webmds
wsdel: gpt wsjava gt4-delegation
wsrft: gpt common wsjava gt4-delegation gt4-rft gt4-rft-test
wsgram: gpt globus-resource-management-server globus-data-management-server wsjava gt4-mds wsrft gt4-gram gt4-gram-test
wscas: gpt wsjava gt4-cas
wsc: gpt globus-gsi gt4-c-ws-core
wsctests: gpt wsjava gt4-c-ws-core-test
wstests: gpt wsjava gt4-java-ws-core-test gt4-c-ws-core-test gt4-mds-test gt4-gram-test gt4-cas-delegation-test gt4-rft-test

# GPT targets
gpt: gpt-stamp
gpt-stamp:
	cd gpt-3.2autotools2004 && OBJECT_MODE=32 ./build_gpt
	touch gpt-stamp
install: postinstall
postinstall:
	${GPT_LOCATION}/sbin/gpt-postinstall

# NCSA targets
gsi-myproxy: gpt globus-gsi myproxy
myproxy: gpt globus_gss_assist globus_gssapi_gsi
	${GPT_LOCATION}/sbin/gpt-build ${BUILD_OPTS} -srcdir=source-trees/myproxy-1.17 ${FLAVOR}
gsi-openssh: gpt globus-gsi gsi_openssh gsi_openssh_setup
gsi_openssh: gpt globus_openssl globus_gss_assist
	${GPT_LOCATION}/sbin/gpt-build ${BUILD_OPTS} -srcdir=source-trees/gsi_openssh-3.5-src ${FLAVOR} @gsiopensshargs@
gsi_openssh_setup: gpt
	${GPT_LOCATION}/sbin/gpt-build ${BUILD_OPTS} -srcdir=source-trees/gsi_openssh_setup-3.5-src ${FLAVOR}

# Bundle dependencies, expressed in packages.
