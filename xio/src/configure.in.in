dnl

AC_REVISION($Revision$)
AC_INIT(Makefile.am)

GLOBUS_INIT

AM_PROG_LIBTOOL

dnl config header goes here

dnl Initialize the automake rules the last argument
AM_INIT_AUTOMAKE($GPT_NAME, $GPT_VERSION)


dnl Build hooks for all 'builtin' drivers
echo -n "Checking for builtin drivers... "
XIO_BUILTIN_DIRS=
XIO_BUILTIN_LIBS=
XIO_BUILTIN_HOOKS_DEC=
XIO_BUILTIN_HOOKS_DEF=
builtins=`ls builtins | grep -v CVS`
delim=
if test "X$builtins" != "X" ; then
  echo
  for builtin in $builtins ; do
    XIO_BUILTIN_DIRS="$XIO_BUILTIN_DIRS builtins/$builtin"
        
    lib_name="builtins/${builtin}/libglobus_xio_${builtin}_driver_${GLOBUS_FLAVOR_NAME}.la"
    XIO_BUILTIN_LIBS="$XIO_BUILTIN_LIBS $lib_name"
    
    XIO_BUILTIN_HOOKS_DEC="$XIO_BUILTIN_HOOKS_DEC $delim globus_i_xio_${builtin}_hook"
    XIO_BUILTIN_HOOKS_DEF="$XIO_BUILTIN_HOOKS_DEF $delim &globus_i_xio_${builtin}_hook"
    delim=","
    echo "Including driver: $builtin"
  done
else
  echo "none found"
fi

AC_SUBST(XIO_BUILTIN_DIRS)
AC_SUBST(XIO_BUILTIN_LIBS)
AC_SUBST(XIO_BUILTIN_HOOKS_DEC)
AC_SUBST(XIO_BUILTIN_HOOKS_DEF)

LAC_DOXYGEN("../", "*.doc")

GLOBUS_FINALIZE

AC_OUTPUT(
    Makefile
    pkgdata/Makefile
    pkgdata/pkg_data_src.gpt
    Makefile
    doxygen/Makefile
    doxygen/Doxyfile
    doxygen/Doxyfile-internal
    version.h
    globus_xio_load.c
dnl NOTE: do not put anything below this line!
