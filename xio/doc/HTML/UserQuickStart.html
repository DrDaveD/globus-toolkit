<HTML>
<HEAD>
    <TITLE>Globus XIO User API Quick Start Guide</TITLE>
    <style type="text/css">
        <!--
            h3 { background-color: #DCE1FF; background-position: left}
        -->
    </style>
</HEAD>
<BODY>
    <IMG SRC="globus_top.gif"><br>
    <IMG SRC="globus.gif"><br>
    <IMG SRC="globus_bottom.gif"><br>
    <H2>Globus XIO User API Quick Start</H2>
    <P>
    <h3><a name="Introduction">Introduction</a></h3>
This Guide explains how to use the Globus XIO API for IO operations within 
C programs.  Since Globus XIO is a simple API it is pretty straight 
forward.  The best way to become familiar with it is by looking at an example.
See <A HREF="globus_xio_example.c">globus_xio_example.c</A>

    <h3><a name="ActivateGlobus">Activate Globus</a></h3>
<BR>
Lets examine the case where a user wishes to use globus xio for reading data
from a file.  As in all globus programs the first thing that must be done is
to activate the globus module.  Until activated no globus_xio function
calls can be successfully executed.  It is activated with the following line:
</P>

<PRE>
    globus_module_activate(GLOBUS_XIO_MODULE);
</PRE>

    <h3><a name="LoadDriver">Load Driver</a></h3>
<P>
The next step is to load all the drivers needed to complete the IO operations
in which you are interested.  The function globus_xio_load_driver() is
used to load a driver.  In order to successfully call this function you must
know the name of all the drivers you wish to load.  For this example we only 
want to load the file io driver.  The prepackaged file io drivers name is:
"file".  This driver would be loaded with the following
code:

<PRE>
    globus_result_t                     res;
    globus_xio_driver_t                 driver;

    res = globus_xio_driver_load(&driver, "file");
</PRE>

If upon completion of the above function call res == GLOBUS_SUCCESS then
the driver was successfully loaded and can be referenced with the variable
"driver".  
<BR>
<I>Note:</I>The string identifying the driver follows a naming convention.
With the above string the file globus_xio_file_driver&lt;flavor&gt;.so should be in the
users LD_LIBRARY_PATH at runtime.
<BR>
    <h3><a name="CreateStack">Create Stack</a></h3>
Now that globus_xio is activated and we have a driver load we need to build
a driver stack.  In our example the stack is very simple as it consists of
only 1 driver, the file driver.  For more info on the stack see <A HREF="">
</A>.  The stack is established with the following code (building off of the
above code snips):
<PRE>
    globus_xio_stack_t              stack;
    
    globus_xio_stack_init(&stack);
    globus_xio_stack_push_driver(stack, driver);

</PRE>
<h3><a name="OpeningHandle">Opening Handle</a></h3>
<P>
Now that the stack is created we can open a handle to the file.  There are two
ways that a handle can be opened.  The first is a passive open.  An example
of this is a TCP listener.  The open is performed passively by waiting
for some other entity to act upon it.  The second is an active open.  An 
active open is the opposite of a passive open.  The TCP counter example for
this is a connect.  The users initiates the open.  In our example we shall
be performing an active open.
<BR>
To open a handle a target object must first be established. The target object
tells globus_xio what it wants to open by associating it with a contact string.
The following code illustrates this:
</P>
<PRE>
    globus_xio_target_t             target;
    globus_xio_handle_t             handle;

    globus_xio_target_init(&target, "/tmp/junk.txt", stack, NULL);

    res = globus_xio_open(
            &handle,
            target,
            NULL);
</PRE>
<P>
Attributes can be passed in to color how the handle is opened.  To learn more
about this see <A HREF=""></A>.
<BR>
Now that we have an open handle to a file we can read or write data to it
with either globus_xio_read() or globus_xio_write().  Once we are finished
performing IO operations on the handle globus_xio_close(handle) should be
called.
<BR>
<h3><a name="PayOff">Pay Off</a></h3>
This May seem like quite a bit of effort for simple reading a file, and it is.
However the advantages become clear when exploring the swapping of other 
drivers.  In the above example it would be trivial to change the io operations
from file IO to TCP, or HTTP, or ftp.  All the the user would need to do is 
change the driver name string passed to globus_xio_load_driver() and the 
contact string passed to globus_xio_target_init().  This can easily be done
at runtime as the program <A HREF="globus_xio_example.c">globus_xio_example.c
</A> demonstrates.
<BR>
Further demonstrated by <A HREF="globus_xio_example.c">globus_xio_example.c
</A> is the ease in changing a globus_xio program from being a client or a 
server.  The only change is how a target is initialized.  To create a server
the target would be setup with the following code:
</P>
<PRE>
    globus_xio_server_t             server;
    char                            buf[256];

    globus_xio_server_init(&server, stack);
    globus_xio_server_cntl(server, NULL, 
        GLOBUS_XIO_CNTL_GET_CONTACT_STRING,
        &buf, sizeof(buf));
    globus_libc_fprintf(stdout, "serving at: %s.\n", buf);
    globus_xio_server_accept(server, &target);
</PRE>
<P>
So the little program <A HREF="globus_xio_example.c">globus_xio_example.c</A>
has the ability to be any reading client, or server, (HTTP, ftp, TCP, file, 
etc) as long as the proper drivers are in the LD_LIBRARY_PATH.  Not bad eh?
</P>
</BODY>
</HTML>


