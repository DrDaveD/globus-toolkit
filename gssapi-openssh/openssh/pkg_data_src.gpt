<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE gpt_package_metadata SYSTEM "globus_package.dtd">

<gpt_package_metadata Format_Version="0.02" Name="gsi_openssh" >

  <Aging_Version Major="2" Minor="3" Age="0" />
  <Description>GSI-Enabled OpenSSH package</Description>
  <Functional_Group >gsi_openssh</Functional_Group>
  <Version_Stability Release="stable" />

  <src_pkg >

    <Build_Environment >
      <cflags ></cflags>
      <external_includes ></external_includes>
      <pkg_libs >-lglobus_gss_assist_$GLOBUS_FLAVOR_NAME -lglobus_gssapi_gsi_$GLOBUS_FLAVOR_NAME -lssl_$GLOBUS_FLAVOR_NAME -lcrypto_$GLOBUS_FLAVOR_NAME</pkg_libs>
      <external_libs >-lutil -lz -lnsl -lcrypt</external_libs>
    </Build_Environment>

    <With_Flavors build="yes" />

    <Version_Label>GSI-OpenSSH 2.3 / OpenSSH 3.6.1p1</Version_Label>

    <Source_Dependencies Type="compile">
      <Dependency Name="globus_openssl">
        <Version>
          <Version_Range Lower_Major="0" Lower_Minor="9" Upper_Major="0" Upper_Minor="40" />
        </Version>
      </Dependency>
      <Dependency Name="globus_gss_assist">
        <Version>
          <Simple_Version Major="2"></Simple_Version>
          <Simple_Version Major="3"></Simple_Version>
        </Version>
      </Dependency>
    </Source_Dependencies>

    <Source_Setup_Dependency PkgType="pgm">
      <Setup_Dependency Name="trusted_ca_setup">
        <Version>
          <Simple_Version Major="2"></Simple_Version>
        </Version>
      </Setup_Dependency>
    </Source_Setup_Dependency>

    <Build_Instructions>

      <Build_Step>
        CONFIGENV_GPTMACRO ./configure --prefix=INSTALLDIR_GPTMACRO --with-globus=INSTALLDIR_GPTMACRO --with-globus-flavor=FLAVOR_GPTMACRO GSI_OPENSSH_GPTMACRO
      </Build_Step>

      <Build_Step>
        MAKE_GPTMACRO gpt-all
      </Build_Step>

      <Build_Step>
        MAKE_GPTMACRO gpt-install
      </Build_Step>

      <Build_Step>mkdir -p INSTALLDIR_GPTMACRO/setup/gsi_openssh_setup/</Build_Step>
      <Build_Step>cp ./gpt/setup/setup-openssh INSTALLDIR_GPTMACRO/setup/gsi_openssh_setup/setup-openssh</Build_Step>
      <Build_Step>cp ./gpt/setup/setup-openssh.pl INSTALLDIR_GPTMACRO/setup/gsi_openssh_setup/setup-openssh.pl</Build_Step>
      <Build_Step>cp ./gpt/setup/SXXsshd.in INSTALLDIR_GPTMACRO/setup/gsi_openssh_setup/SXXsshd.in</Build_Step>
      <Build_Step>cp ./ssh_config INSTALLDIR_GPTMACRO/setup/gsi_openssh_setup/ssh_config</Build_Step>
      <Build_Step>cp ./sshd_config INSTALLDIR_GPTMACRO/setup/gsi_openssh_setup/sshd_config.in</Build_Step>
      <Build_Step>cp ./ssh_prng_cmds.in INSTALLDIR_GPTMACRO/setup/gsi_openssh_setup/ssh_prng_cmds.in</Build_Step>
      <Build_Step>cp ./moduli INSTALLDIR_GPTMACRO/setup/gsi_openssh_setup/moduli</Build_Step>

    </Build_Instructions>

    <Post_Install_Program >
      gsi_openssh_setup/setup-openssh
    </Post_Install_Program>

    <Post_Install_Message >
      Please run GLOBUS_LOCATION/setup/gsi_openssh_setup/setup-openssh.
    </Post_Install_Message>

    <Setup Name="gsi_openssh">
      <Aging_Version Major="2" Minor="3" Age="0" />
    </Setup>

  </src_pkg >

</gpt_package_metadata>
