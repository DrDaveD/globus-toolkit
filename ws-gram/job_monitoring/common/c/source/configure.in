AC_REVISION($Revision$)
AC_INIT(Makefile.am)

GLOBUS_INIT

AM_PROG_LIBTOOL

dnl Initialize the automake rules the last argument
AM_INIT_AUTOMAKE($GPT_NAME, $GPT_VERSION)

LAC_DOXYGEN("../ ./", "*.dox")

AC_ARG_WITH(initscript-config-path,
            AC_HELP_STRING([--with-initscript-config-path=PATH],
            [Set the path to init script configuration. By default, this package
             will install its configuration file in
             ${sysconfdir}/globus-scheduler-event-generator.conf. 
             ]),
            [if test "$withval" = "yes";  then
                AC_MSG_ERROR([Invalid path: $withval])
            else
                SEG_CONFIGDIR=`dirname $withval`
                SEG_CONFIGFILE=`basename $withval`
            fi],
            [
                SEG_CONFIGDIR='${sysconfdir}'
                SEG_CONFIGFILE="globus-scheduler-event-generator.conf"
            ])


AC_SUBST(SEG_CONFIGDIR)
AC_SUBST(SEG_CONFIGFILE)

AC_ARG_WITH(lockfile-path,
            AC_HELP_STRING([--with-lockfile-path=PATH],
            [Set the path to init script lockfile]),
            [if test "$withval" = "yes";  then
                AC_MSG_ERROR([Invalid path: $withval])
            else
                LOCKFILE="$withval"
            fi],
            [
                LOCKFILE="\${localstatedir}/lock/globus-scheduler-event-generator"
            ])
AC_SUBST(LOCKFILE)


LSB="-nolsb"
AC_ARG_WITH(lsb,
        AC_HELP_STRING(
            [--with-lsb],
            [Enable use of LSB support functions in the
             globus-scheduler-event-generator init script. If set, it will use
             linux-specific functions to start
             and stop the globus-scheduler-event-generator service and log its
             status changes. This script will probe for the LSB base scripts if
             this is not set.  If not found, it will use a generic service
             startup script.]),
            [ if test "$withval" = yes; then
                LSB="-lsb"
              fi],
            [
                if test -f /lib/lsb/init-functions; then
                    LSB="-lsb"
                fi
            ])

AC_SUBST(LSB)

GLOBUS_FINALIZE

AC_OUTPUT(
        globus-scheduler-event-generator-admin
	Makefile
	pkgdata/Makefile
	pkgdata/pkg_data_src.gpt
	doxygen/Makefile
	doxygen/Doxyfile
	doxygen/Doxyfile-internal
        config/Makefile
        init/globus-scheduler-event-generator-nolsb
        init/globus-scheduler-event-generator-lsb
        init/Makefile
	version.h
)
